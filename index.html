<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ì„ ë¬¼ ì¶”ì²œê¸°ğŸ</title>
  </head>
  <body style="font-family: Arial, sans-serif; padding: 20px">
    <h1>ğŸ 5ë¶„ë§Œì— ì„ ë¬¼ ì¶”ì²œë°›ê¸°</h1>

    <div id="question-box">
      <p id="question"></p>
      <input type="text" id="answer" style="width: 300px" />
      <button onclick="submitAnswer()">ë‹¤ìŒ</button>
    </div>

    <div id="result-box" style="margin-top: 30px"></div>

    <script>
          const questions = [
            "ëˆ„êµ¬ì—ê²Œ ì„ ë¬¼í•  ê±´ê°€ìš”? (ê°€ì¡±, ì—°ì¸, ì¹œêµ¬, ë™ë£Œ ì¤‘)",
            "ê·¸ ë¶„ì˜ ë‚˜ì´ëŠ” ëŒ€ëµ ëª‡ ì‚´ì¯¤ ë ê¹Œìš”?",
            "ìš”ì¦˜ ê·¸ë¶„ì´ ì¢‹ì•„í•˜ê±°ë‚˜ ê´€ì‹¬ ìˆì–´ í•˜ëŠ” ê²ƒë“¤ì´ ìˆì„ê¹Œìš”?",
            "ì´ë²ˆ ì„ ë¬¼ì€ ì–´ë–¤ ìƒí™©ì„ ìœ„í•œ ê±´ê°€ìš”? (ex. ìƒì¼, ì…ì‚¬ ì¶•í•˜, ê°ì‚¬ ì¸ì‚¬ ë“±)"
          ];

          let currentIndex = 0;
          let answers = [];

          const openaiApiKey = import.meta.env?.VITE_OPENAI_API_KEY || "YOUR_OPENAI_API_KEY_HERE"; // .envì—ì„œ ë„£ì„ ì˜ˆì •

          document.getElementById('question').innerText = questions[currentIndex];

          function submitAnswer() {
            const input = document.getElementById('answer').value.trim();
            if (!input) return alert("ë‹µë³€ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");

            answers.push(input);
            document.getElementById('answer').value = "";

            currentIndex++;

            if (currentIndex < questions.length) {
              document.getElementById('question').innerText = questions[currentIndex];
            } else {
              document.getElementById('question-box').style.display = 'none';
              askOpenAI();
            }
          }

          async function askOpenAI() {
            const prompt = `
      ë‹¹ì‹ ì€ ë›°ì–´ë‚œ ì„ ë¬¼ ì¶”ì²œ ë„ìš°ë¯¸ì…ë‹ˆë‹¤.

      ì•„ë˜ ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ì°¸ê³ í•˜ì—¬,
      "ì„ ë¬¼ í‚¤ì›Œë“œ" 4ê°œë¥¼ ì¶”ì²œí•´ì£¼ì„¸ìš”.
      - í‚¤ì›Œë“œëŠ” ì§§ê²Œ (1~2ë‹¨ì–´)
      - ì„œë¡œ ë‹¤ë¥¸ ì¹´í…Œê³ ë¦¬ë¡œ ë‹¤ì–‘í•˜ê²Œ ì¶”ì²œ
      - ì„ ë¬¼ ëŒ€ìƒê³¼ ìƒí™©ì„ ê³ ë ¤í•´ì„œ í˜„ì‹¤ì„± ìˆê²Œ ì¶”ì²œ

      ì‚¬ìš©ì ì •ë³´:
      - ê´€ê³„: ${answers[0]}
      - ë‚˜ì´: ${answers[1]}
      - ê´€ì‹¬ì‚¬: ${answers[2]}
      - ìƒí™©: ${answers[3]}

      ê²°ê³¼ëŠ” JSON ë°°ì—´ í˜•ì‹ìœ¼ë¡œë§Œ ì¶œë ¥í•´ì£¼ì„¸ìš”.
      ì˜ˆì‹œ: ["í–¥ìˆ˜", "ìš´ë™í™”", "ì»¤í”¼ë¨¸ì‹ ", "ê½ƒë‹¤ë°œ"]
      `;

            const response = await fetch("https://api.openai.com/v1/chat/completions", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                "Authorization": `Bearer ${openaiApiKey}`
              },
              body: JSON.stringify({
                model: "gpt-4o", // ë˜ëŠ” gpt-3.5-turbo
                messages: [{ role: "user", content: prompt }],
                temperature: 0.7
              })
            });

            const data = await response.json();
            const content = data.choices[0].message.content;

            try {
              const keywords = JSON.parse(content);
              showResult(keywords);
            } catch (error) {
              document.getElementById('result-box').innerHTML = `<p>í‚¤ì›Œë“œ ì¶”ì¶œ ì‹¤íŒ¨ ğŸ˜­ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</p>`;
              console.error(error);
            }
          }

          function showResult(keywords) {
            const resultBox = document.getElementById('result-box');
            resultBox.innerHTML = `
              <h2>ğŸ ì¶”ì²œ í‚¤ì›Œë“œ</h2>
              <ul>
                ${keywords.map(word => `<li>${word}</li>`).join('')}
              </ul>
            `;
          }
    </script>
  </body>
</html>
